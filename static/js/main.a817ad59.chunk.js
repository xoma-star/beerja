(this.webpackJsonpgame=this.webpackJsonpgame||[]).push([[0],{125:function(e,t,c){},127:function(e,t,c){},149:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/adobe--big.98cc2849.svg"},150:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/alphabet--big.1fd8d0cf.svg"},151:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/amazon--big.86572285.svg"},152:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/american-express--big.f2f13164.svg"},153:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/apple--big.47cacdad.svg"},154:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/blackrock--big.23dd7937.svg"},155:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/coca-cola--big.0b539a92.svg"},156:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/garmin-ltd--big.96a04453.svg"},157:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/intel--big.0cfaf02c.svg"},158:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/microsoft--big.dcfa5bc3.svg"},159:function(e,t,c){"use strict";c.r(t);var s=c(2),n=c.n(s),a=c(34),r=c.n(a),i=(c(125),c(39)),o=c(20),l=c.n(o),u=c(25),d=c(47),b=c(48),j=c(31),h=c(54),f=c(53),v=(c(127),c(128),c(7)),p=c(162),g=c(163),x=c(164),O=c(165),k=c(5),m=function(e){var t={rub:["\u0440\u0443\u0431\u043b\u044f\u0445","\u0420"],usd:["\u0434\u043e\u043b\u043b\u0430\u0440\u0430\u0445","$"],eur:["\u0435\u0432\u0440\u043e","E"]};return Object(k.jsxs)(v.f,{style:{padding:16},children:[Object(k.jsxs)(v.B,{weight:"regular",children:["\u0432 ",t[e.a][0]]}),Object(k.jsxs)(v.C,{level:1,weight:"semibold",children:[(1e4/e.b).toFixed(2)," ",t[e.a][1]]})]})},y=function(e){return Object(k.jsx)(v.n,{header:Object(k.jsx)(v.o,{mode:"secondary",children:"\u0421\u0447\u0435\u0442"}),children:Object(k.jsxs)(v.g,{size:"s",children:[Object(k.jsx)(m,{a:"rub",b:e.c.rub}),Object(k.jsx)(m,{a:"usd",b:e.c.usd}),Object(k.jsx)(m,{a:"eur",b:e.c.eur})]})})},P=c(40);P.a.initializeApp({apiKey:"AIzaSyDlCktyJU_nwYj-6SDlguxSLRAk6weznEQ",authDomain:"beerja-84e5f.firebaseapp.com",projectId:"beerja-84e5f",storageBucket:"beerja-84e5f.appspot.com",messagingSenderId:"453501298891",appId:"1:453501298891:web:f31455addf2f4bb85d934e"});var A=P.a.firestore(),w={AAPL:{name:"Apple Inc.",logo:"apple--big.svg"},ADBE:{name:"Adobe",logo:"adobe--big.svg"},GOOG:{name:"Alphabet Inc.",logo:"alphabet--big.svg"},AMZN:{name:"Amazon",logo:"amazon--big.svg"},AXP:{name:"American Express Company",logo:"american-express--big.svg"},BLK:{name:"BlackRock, Inc.",logo:"blackrock--big.svg"},KO:{name:"Coca-Cola",logo:"coca-cola--big.svg"},GRMN:{name:"Garmin LTD.",logo:"garmin-ltd--big.svg"},INTC:{name:"Intel",logo:"intel--big.svg"},MSFT:{name:"Microsoft",logo:"microsoft--big.svg"}},C=function(e){var t=e.c,s=e.v,n=e.a,a=(e.b,w[s]),r=(t/n*100-100).toFixed(2),i=t-n;return Object(k.jsx)(v.h,{onClick:function(){e.s("stock",s)},before:Object(k.jsx)(v.c,{size:32,src:c(46)("./".concat(a.logo)).default}),description:e.p?Object(k.jsxs)(v.e,{level:2,weight:"regular",children:["3x",t.toFixed(2),"$"]}):"",indicator:Object(k.jsxs)("div",{style:{textAlign:"right"},children:[Object(k.jsxs)(v.C,{style:{color:"#000"},level:3,weight:"medium",children:[e.p?(3*t).toFixed(2):t.toFixed(2),"$"]}),Object(k.jsxs)(v.e,{style:r>=0?{color:"var(--dynamic_green)"}:{color:"var(--dynamic_red)"},level:2,weight:"regular",children:[i.toFixed(2),"$ (",r,"%)"]})]}),children:Object(k.jsx)(v.C,{level:3,weight:"semibold",children:a.name})})},S=c(41),M=c(161),B=c(160),z=function(e){var t=Object(s.useState)(null),c=Object(S.a)(t,2),n=c[0],a=c[1],r=Object(s.useState)(0),i=Object(S.a)(r,2),o=i[0],l=i[1],u=function(){e.s(null,null),setTimeout((function(){a(null),l(0)}),250)};return Object(k.jsx)(v.u,{activeModal:e.v,onClose:u,children:Object(k.jsx)(v.s,{id:"stock",header:Object(k.jsx)(v.t,{left:Object(k.jsx)(v.w,{onClick:u}),children:Object(k.jsx)(v.o,{children:e.t})}),dynamicContentHeight:!0,children:Object(k.jsx)(v.m,{children:null===n?Object(k.jsxs)(v.l,{style:{display:"flex"},children:[Object(k.jsx)(v.d,{onClick:function(){a("buy")},mode:"commerce",stretched:!0,size:"l",children:"\u041a\u0443\u043f\u0438\u0442\u044c"}),Object(k.jsx)("div",{style:{width:10}}),Object(k.jsx)(v.d,{onClick:function(){a("sell")},mode:"destructive",stretched:!0,size:"l",children:"\u041f\u0440\u043e\u0434\u0430\u0442\u044c"})]}):Object(k.jsxs)("div",{children:[Object(k.jsx)(v.l,{children:Object(k.jsx)(v.C,{level:1,weight:"bold",children:"buy"===n?"\u041f\u043e\u043a\u0443\u043f\u043a\u0430":"\u041f\u0440\u043e\u0434\u0430\u0436\u0430"})}),Object(k.jsx)(v.l,{children:Object(k.jsx)(v.r,{disabled:!0,value:123})}),Object(k.jsx)(v.l,{children:Object(k.jsx)(v.C,{level:1,weight:"bold",children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"})}),Object(k.jsx)(v.l,{bottom:"\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e 2",children:Object(k.jsx)(v.r,{after:Object(k.jsxs)("div",{style:{display:"flex"},children:[Object(k.jsx)(v.q,{icon:Object(k.jsx)(M.a,{})}),Object(k.jsx)(v.q,{icon:Object(k.jsx)(B.a,{})})]}),onChange:function(e){return l(("0"===(t=(t=e.target.value).replace(/[^0-9]/g,"")).charAt(0)&&t>0&&(t=t.substr(1)),0===t.length&&(t=0),t));var t},value:o})}),Object(k.jsx)(v.l,{children:Object(k.jsx)(v.d,{size:"l",stretched:!0,children:"buy"===n?"\u041a\u0443\u043f\u0438\u0442\u044c":"\u041f\u0440\u043e\u0434\u0430\u0442\u044c"})})]})})})})},q=function(e){Object(h.a)(s,e);var t=Object(f.a)(s);function s(e){var c;return Object(d.a)(this,s),(c=t.call(this,e)).state={activePanel:"portfolio",userPortfolio:[],stockPrices:[],avgPrices:[],sharesCount:[],currencies:{rub:1,usd:72.44,eur:81.12},stocksMarket:[],modal:null},c.api_key="CKB1ZOZN09CF26RO6LPJ",c.api_secret="cBuWsqBlsuB5aAf8c0qqHrL9jy5SWqX3kY9e6Qao",c.getPrice=c.getPrice.bind(Object(j.a)(c)),c.getUserStocks=c.getUserStocks.bind(Object(j.a)(c)),c.setActiveModal=c.setActiveModal.bind(Object(j.a)(c)),c}return Object(b.a)(s,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,c,s,n=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getUserStocks().then((function(e){n.portfolioInit(e).then((function(e){n.setState(e)}))}));case 2:t=0,c=["ADBE","GOOG","AXP","AMZN","BLK","AAPL","KO","GRMN","INTC","MSFT"];case 4:if(!(t<c.length)){e.next=11;break}return s=c[t],e.next=8,this.pushStock(s);case 8:t++,e.next=4;break;case 11:this.connectAlpacaWSS();case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserStocks",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.collection("users").doc("1").get().then((function(e){return t=e.data().portfolio}));case 2:return e.next=4,Promise.resolve(t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"connectAlpacaWSS",value:function(){var e=this,t=new WebSocket("wss://stream.data.sandbox.alpaca.markets/v2/iex");t.onopen=function(){t.send('{"action":"auth","key":"CKB1ZOZN09CF26RO6LPJ","secret":"cBuWsqBlsuB5aAf8c0qqHrL9jy5SWqX3kY9e6Qao"}')},t.onmessage=function(c){var s=JSON.parse(c.data)[0];"authenticated"===s.msg&&t.send('{"action":"subscribe","trades":["AAPL","AMD"]}'),"t"===s.T&&e.stockPriceUpdate(s.S,s.p)}}},{key:"stockPriceUpdate",value:function(e,t){var c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=this.state.avgPrices;c&&(s=this.state.stockPrices);var n=this.state.userPortfolio.indexOf(e);s[n]=t,this.setState(s?{stockPrices:s}:{avgPrices:s})}},{key:"portfolioInit",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var c,s,n,a,r,o,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=[],s=[],n=[],a=[],r=Object(i.a)(t),e.prev=5,r.s();case 7:if((o=r.n()).done){e.next=16;break}return u=o.value,c.push(u.ticker),s.push(u.avgPrice),n.push(u.count),e.next=14,this.getPrice(u.ticker).then((function(e){return a.push(e.trade.p)}));case 14:e.next=7;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(5),r.e(e.t0);case 21:return e.prev=21,r.f(),e.finish(21);case 24:return e.abrupt("return",{userPortfolio:c,avgPrices:s,sharesCount:n,stockPrices:a});case 25:case"end":return e.stop()}}),e,this,[[5,18,21,24]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pushStock",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var c,s,n,a=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=this.state.stocksMarket,s=Object(i.a)(c),e.prev=2,s.s();case 4:if((n=s.n()).done){e.next=10;break}if(n.value.ticker!==t){e.next=8;break}return e.abrupt("return",!1);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),s.e(e.t0);case 15:return e.prev=15,s.f(),e.finish(15);case 18:this.getPrice(t).then(function(){var e=Object(u.a)(l.a.mark((function e(s){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getPrice(t,s.trade.t);case 2:n=e.sent,c.push({ticker:t,name:w[t].name,price:s.trade.p,priceBefore:n.trades[0].p});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.setState({stocksMarket:c}),console.log(this.state);case 21:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getPrice",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var c,s,n,a=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=a.length>1&&void 0!==a[1]?a[1]:null,n="https://data.sandbox.alpaca.markets/v2/stocks/"+t+"/trades/latest",null!==c&&(n="https://data.sandbox.alpaca.markets/v2/stocks/"+t+"/trades?limit=10&start="+new Date(Date.parse(c)-864e5).toISOString()),e.next=5,fetch(n,{method:"GET",mode:"cors",headers:{Authorization:"Basic "+window.btoa(this.api_key+":"+this.api_secret)}}).catch((function(){})).then((function(e){s=e.json()}));case 5:return e.next=7,Promise.resolve(s);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setActivePanel",value:function(e){this.setState({activePanel:e})}},{key:"setActiveModal",value:function(e,t){this.setState({activeModal:e,activeTicker:t})}},{key:"render",value:function(){var e=this,t=this.props.platform;return Object(k.jsx)(v.i,{platform:t,scheme:"bright_light",children:Object(k.jsx)(v.a,{children:Object(k.jsxs)(v.b,{children:[Object(k.jsx)(v.y,{modal:Object(k.jsx)(z,{v:this.state.activeModal,s:this.setActiveModal,t:this.state.activeTicker}),children:Object(k.jsxs)(v.D,{activePanel:this.state.activePanel,children:[Object(k.jsxs)(v.v,{id:"portfolio",children:[Object(k.jsx)(y,{c:this.state.currencies}),Object(k.jsx)(v.n,{header:Object(k.jsx)(v.o,{mode:"secondary",children:"\u0411\u0443\u043c\u0430\u0433\u0438"}),children:this.state.stockPrices.length>0?this.state.userPortfolio.map((function(t,c){var s=e.state.avgPrices[c],n=e.state.sharesCount[c],a=e.state.stockPrices[c];return Object(k.jsx)(C,{a:s,b:n,c:a,v:t,p:!0,s:e.setActiveModal},a+t)})):Object(k.jsx)(v.x,{icon:Object(k.jsx)(p.a,{}),header:Object(k.jsx)(v.o,{children:"\u0417\u0434\u0435\u0441\u044c \u043f\u043e\u043a\u0430 \u043f\u0443\u0441\u0442\u043e"}),action:Object(k.jsx)(v.d,{onClick:function(){return e.setActivePanel("quotes")},size:"m",children:"\u041a \u043f\u043e\u043a\u0443\u043f\u043a\u0430\u043c"})})})]}),Object(k.jsxs)(v.v,{id:"quotes",children:[Object(k.jsx)(v.n,{header:Object(k.jsx)(v.o,{mode:"secondary",children:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e"}),children:this.state.stocksMarket.map((function(e,t){return Object(k.jsx)(C,{a:e.priceBefore,b:0,c:e.price,v:e.ticker,p:!1},e.price+e.ticker)}))}),Object(k.jsx)(v.n,{header:Object(k.jsx)(v.o,{mode:"secondary",children:"\u043d\u0430 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0439 \u043d\u0435\u0434\u0435\u043b\u0435"}),children:Object(k.jsx)(v.g,{children:this.state.stocksMarket.map((function(e,t){return Object(k.jsx)(v.p,{children:Object(k.jsx)(v.c,{size:64,src:c(46)("./".concat(StocksData[e.ticker].logo)).default})})}))})})]}),Object(k.jsx)(v.v,{id:"rating"})]})}),Object(k.jsx)(v.k,{children:Object(k.jsx)(v.j,{activeStory:this.state.activePanel,tabbar:Object(k.jsxs)(v.z,{children:[Object(k.jsx)(v.A,{selected:"portfolio"===this.state.activePanel,id:"portfolio",onClick:function(){return e.setActivePanel("portfolio")},text:"\u041f\u043e\u0440\u0442\u0444\u0435\u043b\u044c",children:Object(k.jsx)(g.a,{})}),Object(k.jsx)(v.A,{selected:"quotes"===this.state.activePanel,id:"quotes",onClick:function(){return e.setActivePanel("quotes")},text:"\u041c\u0430\u0440\u043a\u0435\u0442",children:Object(k.jsx)(x.a,{})}),Object(k.jsx)(v.A,{selected:"rating"===this.state.activePanel,id:"rating",onClick:function(){return e.setActivePanel("rating")},text:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433",children:Object(k.jsx)(O.a,{})})]})})})]})})})}}]),s}(n.a.Component);Object(v.E)(q);var D=q,F=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,166)).then((function(t){var c=t.getCLS,s=t.getFID,n=t.getFCP,a=t.getLCP,r=t.getTTFB;c(e),s(e),n(e),a(e),r(e)}))};r.a.render(Object(k.jsx)(n.a.StrictMode,{children:Object(k.jsx)(D,{})}),document.getElementById("root")),F()},46:function(e,t,c){var s={"./adobe--big.svg":149,"./alphabet--big.svg":150,"./amazon--big.svg":151,"./american-express--big.svg":152,"./apple--big.svg":153,"./blackrock--big.svg":154,"./coca-cola--big.svg":155,"./garmin-ltd--big.svg":156,"./intel--big.svg":157,"./microsoft--big.svg":158};function n(e){var t=a(e);return c(t)}function a(e){if(!c.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}n.keys=function(){return Object.keys(s)},n.resolve=a,e.exports=n,n.id=46}},[[159,1,2]]]);
//# sourceMappingURL=main.a817ad59.chunk.js.map