(this.webpackJsonpgame=this.webpackJsonpgame||[]).push([[0],{125:function(e,t,c){},127:function(e,t,c){},149:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/adobe--big.98cc2849.svg"},150:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/alphabet--big.1fd8d0cf.svg"},151:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/amazon--big.86572285.svg"},152:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/american-express--big.f2f13164.svg"},153:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/apple--big.47cacdad.svg"},154:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/blackrock--big.23dd7937.svg"},155:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/coca-cola--big.0b539a92.svg"},156:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/garmin-ltd--big.96a04453.svg"},157:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/intel--big.0cfaf02c.svg"},158:function(e,t,c){"use strict";c.r(t),t.default=c.p+"static/media/microsoft--big.dcfa5bc3.svg"},159:function(e,t,c){"use strict";c.r(t);var s=c(2),a=c.n(s),n=c(34),i=c.n(n),r=(c(125),c(39)),o=c(20),l=c.n(o),u=c(27),d=c(47),b=c(48),h=c(26),j=c(54),p=c(53),v=(c(127),c(128),c(7)),f=c(162),g=c(163),x=c(164),O=c(165),m=c(5),k=function(e){var t,c={rub:["\u0440\u0443\u0431\u043b\u044f\u0445","\u20bd"],usd:["\u0434\u043e\u043b\u043b\u0430\u0440\u0430\u0445","$"],eur:["\u0435\u0432\u0440\u043e","\u20ac"]};return t=e.c?Object(m.jsxs)(v.D,{level:1,weight:"semibold",children:[(e.c/e.b+e.d).toFixed(2)," ",c[e.a][1]]}):Object(m.jsx)(v.y,{style:{height:28},size:"regular"}),Object(m.jsx)(v.f,{style:{padding:16},children:Object(m.jsxs)("div",{children:[Object(m.jsxs)(v.C,{weight:"regular",children:["\u0432 ",c[e.a][0]]}),t]})})},y=function(e){var t=e.p*e.e,c=t*e.c.usd,s=c/e.c.eur;return console.log(e.c.rub),Object(m.jsx)(v.n,{header:Object(m.jsx)(v.o,{mode:"secondary",children:"\u0421\u0447\u0435\u0442"}),children:Object(m.jsxs)(v.g,{size:"s",children:[Object(m.jsx)(k,{a:"rub",b:e.c.rub,c:e.b,d:c}),Object(m.jsx)(k,{a:"usd",b:e.c.usd,c:e.b,d:t}),Object(m.jsx)(k,{a:"eur",b:e.c.eur,c:e.b,d:s})]})})},P=c(40);P.a.initializeApp({apiKey:"AIzaSyDlCktyJU_nwYj-6SDlguxSLRAk6weznEQ",authDomain:"beerja-84e5f.firebaseapp.com",projectId:"beerja-84e5f",storageBucket:"beerja-84e5f.appspot.com",messagingSenderId:"453501298891",appId:"1:453501298891:web:f31455addf2f4bb85d934e"});var A=P.a.firestore(),S={AAPL:{name:"Apple Inc.",logo:"apple--big.svg"},ADBE:{name:"Adobe",logo:"adobe--big.svg"},GOOG:{name:"Alphabet Inc.",logo:"alphabet--big.svg"},AMZN:{name:"Amazon",logo:"amazon--big.svg"},AXP:{name:"American Express Company",logo:"american-express--big.svg"},BLK:{name:"BlackRock, Inc.",logo:"blackrock--big.svg"},KO:{name:"Coca-Cola",logo:"coca-cola--big.svg"},GRMN:{name:"Garmin LTD.",logo:"garmin-ltd--big.svg"},INTC:{name:"Intel",logo:"intel--big.svg"},MSFT:{name:"Microsoft",logo:"microsoft--big.svg"}},w=function(e){var t=e.c,s=e.v,a=e.a,n=e.b,i=S[s],r=(t/a*100-100).toFixed(2),o=t-a;return console.log(t,a),Object(m.jsx)(v.h,{onClick:function(){e.s("stock",s)},before:Object(m.jsx)(v.c,{size:32,src:c(46)("./".concat(i.logo)).default}),description:e.p?Object(m.jsxs)(v.e,{level:2,weight:"regular",children:[n,"x",t.toFixed(2),"$"]}):"",indicator:Object(m.jsxs)("div",{style:{textAlign:"right"},children:[Object(m.jsxs)(v.D,{style:{color:"#000"},level:3,weight:"medium",children:[e.p?(n*t).toFixed(2):t.toFixed(2),"$"]}),Object(m.jsxs)(v.e,{style:r>=0?{color:"var(--dynamic_green)"}:{color:"var(--dynamic_red)"},level:2,weight:"regular",children:[(n*o).toFixed(2),"$ (",r,"%)"]})]}),children:Object(m.jsx)(v.D,{level:3,weight:"semibold",children:i.name})})},C=c(41),M=c(161),B=c(160),D=function(e){var t=Object(s.useState)(null),c=Object(C.a)(t,2),a=c[0],n=c[1],i=Object(s.useState)(0),r=Object(C.a)(i,2),o=r[0],l=r[1],u=function(){e.s(null,e.m[0].ticker),setTimeout((function(){n(null),l(0)}),250)};return"undefined"===typeof e.m[0]&&(e={v:null,m:[{ticker:"",name:"",price:0,priceBefore:0}]}),Object(m.jsx)(v.u,{activeModal:e.v,onClose:u,children:Object(m.jsx)(v.s,{id:"stock",header:Object(m.jsx)(v.t,{left:Object(m.jsx)(v.w,{onClick:u}),children:Object(m.jsx)(v.o,{children:e.m[0].name})}),dynamicContentHeight:!0,children:Object(m.jsx)(v.m,{children:null===a?Object(m.jsxs)(v.l,{style:{display:"flex"},children:[Object(m.jsx)(v.d,{onClick:function(){n("buy")},mode:"commerce",stretched:!0,size:"l",children:"\u041a\u0443\u043f\u0438\u0442\u044c"}),Object(m.jsx)("div",{style:{width:10}}),Object(m.jsx)(v.d,{onClick:function(){n("sell")},mode:"destructive",stretched:!0,size:"l",children:"\u041f\u0440\u043e\u0434\u0430\u0442\u044c"})]}):Object(m.jsxs)("div",{children:[Object(m.jsx)(v.l,{children:Object(m.jsx)(v.D,{level:1,weight:"bold",children:"buy"===a?"\u041f\u043e\u043a\u0443\u043f\u043a\u0430":"\u041f\u0440\u043e\u0434\u0430\u0436\u0430"})}),Object(m.jsx)(v.l,{children:Object(m.jsx)(v.r,{disabled:!0,value:e.m[0].price.toFixed(2)})}),Object(m.jsx)(v.l,{children:Object(m.jsx)(v.D,{level:1,weight:"bold",children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"})}),Object(m.jsx)(v.l,{bottom:"\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e 2",children:Object(m.jsx)(v.r,{after:Object(m.jsxs)("div",{style:{display:"flex"},children:[Object(m.jsx)(v.q,{icon:Object(m.jsx)(M.a,{})}),Object(m.jsx)(v.q,{icon:Object(m.jsx)(B.a,{})})]}),onChange:function(e){return l(("0"===(t=(t=e.target.value).replace(/[^0-9]/g,"")).charAt(0)&&t>0&&(t=t.substr(1)),0===t.length&&(t=0),t));var t},value:o})}),Object(m.jsx)(v.l,{children:Object(m.jsx)(v.d,{size:"l",stretched:!0,children:"buy"===a?"\u041a\u0443\u043f\u0438\u0442\u044c":"\u041f\u0440\u043e\u0434\u0430\u0442\u044c"})})]})})})})},z=function(e){var t=S[e.v.ticker];return Object(m.jsx)(v.p,{children:Object(m.jsx)(v.c,{size:64,src:c(46)("./".concat(t.logo)).default})})},F=c(22),I=c.n(F),q=function(e){Object(j.a)(c,e);var t=Object(p.a)(c);function c(e){var s;return Object(d.a)(this,c),(s=t.call(this,e)).state={activePanel:"portfolio",userPortfolio:[],stockPrices:[],avgPrices:[],sharesCount:[],currencies:{rub:1,usd:72.44,eur:81.12},stocksMarket:[],modal:null,loading:!0,scheme:"bright_light"},s.api_key="CKB1ZOZN09CF26RO6LPJ",s.api_secret="cBuWsqBlsuB5aAf8c0qqHrL9jy5SWqX3kY9e6Qao",s.getPrice=s.getPrice.bind(Object(h.a)(s)),s.getUserStocks=s.getUserStocks.bind(Object(h.a)(s)),s.setActiveModal=s.setActiveModal.bind(Object(h.a)(s)),s.userDataUpdatesSubscribe=s.userDataUpdatesSubscribe.bind(Object(h.a)(s)),s}return Object(b.a)(c,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,c,s,a=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.userDataUpdatesSubscribe(),t=0,c=["ADBE","GOOG","AXP","AMZN","BLK","AAPL","KO","GRMN","INTC","MSFT"];case 3:if(!(t<c.length)){e.next=10;break}return s=c[t],e.next=7,this.pushStock(s);case 7:t++,e.next=3;break;case 10:return this.connectAlpacaWSS(),e.next=13,I.a.subscribe((function(e){console.log(e),"VKWebAppUpdateConfig"===e.type&&a.setState({scheme:e.data.scheme})}));case 13:I.a.send("VKWebAppInit");case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserStocks",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.collection("users").doc("1").get().then((function(e){return t=e.data()}));case 2:return e.next=4,Promise.resolve(t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"userDataUpdatesSubscribe",value:function(){var e=this;this.setState({loading:!0}),A.collection("users").doc("1").onSnapshot((function(t){e.portfolioInit(t.data().portfolio).then((function(c){c.balance=t.data().balance,c.loading=!1,e.setState(c)}))}))}},{key:"connectAlpacaWSS",value:function(){var e=this,t=new WebSocket("wss://stream.data.sandbox.alpaca.markets/v2/iex");t.onopen=function(){t.send('{"action":"auth","key":"CKB1ZOZN09CF26RO6LPJ","secret":"cBuWsqBlsuB5aAf8c0qqHrL9jy5SWqX3kY9e6Qao"}')},t.onmessage=function(c){var s=JSON.parse(c.data)[0];"authenticated"===s.msg&&t.send('{"action":"subscribe","trades":["AAPL","AMD"]}'),"t"===s.T&&e.stockPriceUpdate(s.S,s.p)}}},{key:"stockPriceUpdate",value:function(e,t){var c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=this.state.avgPrices;c&&(s=this.state.stockPrices);var a=this.state.userPortfolio.indexOf(e);s[a]=t,this.setState(s?{stockPrices:s}:{avgPrices:s})}},{key:"portfolioInit",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var c,s,a,n,i,o,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=[],s=[],a=[],n=[],i=Object(r.a)(t),e.prev=5,i.s();case 7:if((o=i.n()).done){e.next=16;break}return u=o.value,c.push(u.ticker),s.push(u.avgPrice),a.push(u.count),e.next=14,this.getPrice(u.ticker).then((function(e){return n.push(e.trade.p)}));case 14:e.next=7;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(5),i.e(e.t0);case 21:return e.prev=21,i.f(),e.finish(21);case 24:return e.abrupt("return",{userPortfolio:c,avgPrices:s,sharesCount:a,stockPrices:n});case 25:case"end":return e.stop()}}),e,this,[[5,18,21,24]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pushStock",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var c,s,a,n=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=this.state.stocksMarket,s=Object(r.a)(c),e.prev=2,s.s();case 4:if((a=s.n()).done){e.next=10;break}if(a.value.ticker!==t){e.next=8;break}return e.abrupt("return",!1);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),s.e(e.t0);case 15:return e.prev=15,s.f(),e.finish(15);case 18:this.getPrice(t).then(function(){var e=Object(u.a)(l.a.mark((function e(s){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getPrice(t,s.trade.t);case 2:a=e.sent,c.push({ticker:t,name:S[t].name,price:s.trade.p,priceBefore:a.trades[0].p});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.setState({stocksMarket:c});case 20:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getPrice",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var c,s,a,n=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.length>1&&void 0!==n[1]?n[1]:null,a="https://data.sandbox.alpaca.markets/v2/stocks/"+t+"/trades/latest",null!==c&&(a="https://data.sandbox.alpaca.markets/v2/stocks/"+t+"/trades?limit=10&start="+new Date(Date.parse(c)-864e5).toISOString()),e.next=5,fetch(a,{method:"GET",mode:"cors",headers:{Authorization:"Basic "+window.btoa(this.api_key+":"+this.api_secret)}}).catch((function(){})).then((function(e){s=e.json()}));case 5:return e.next=7,Promise.resolve(s);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setActivePanel",value:function(e){this.setState({activePanel:e})}},{key:"setActiveModal",value:function(e,t){this.setState({activeModal:e,activeTicker:t})}},{key:"render",value:function(){var e=this,t=this.props.platform;return Object(m.jsx)(v.i,{platform:t,scheme:this.state.scheme,children:Object(m.jsx)(v.a,{children:Object(m.jsxs)(v.b,{children:[Object(m.jsx)(v.z,{modal:Object(m.jsx)(D,{v:this.state.activeModal,s:this.setActiveModal,t:this.state.activeTicker,m:this.state.stocksMarket.filter((function(t){return t.ticker===e.state.activeTicker}))}),children:Object(m.jsxs)(v.E,{activePanel:this.state.activePanel,children:[Object(m.jsxs)(v.v,{id:"portfolio",children:[Object(m.jsx)(y,{c:this.state.currencies,b:this.state.balance,p:this.state.stockPrices,e:this.state.sharesCount}),Object(m.jsx)(v.n,{header:Object(m.jsx)(v.o,{mode:"secondary",children:"\u0411\u0443\u043c\u0430\u0433\u0438"}),children:this.state.stockPrices.length>0&&!this.state.loading?this.state.userPortfolio.map((function(t,c){var s=e.state.avgPrices[c],a=e.state.sharesCount[c],n=e.state.stockPrices[c];return Object(m.jsx)(w,{a:s,b:a,c:n,v:t,p:!0,s:e.setActiveModal},n+t)})):Object(m.jsx)(v.x,{icon:this.state.loading?Object(m.jsx)(v.y,{size:"large"}):Object(m.jsx)(f.a,{}),header:this.state.loading?"":Object(m.jsx)(v.o,{children:"\u0417\u0434\u0435\u0441\u044c \u043f\u043e\u043a\u0430 \u043f\u0443\u0441\u0442\u043e"}),action:this.state.loading?"":Object(m.jsx)(v.d,{onClick:function(){return e.setActivePanel("quotes")},size:"m",children:"\u041a \u043f\u043e\u043a\u0443\u043f\u043a\u0430\u043c"})})}),Object(m.jsx)("div",{style:{height:48}})]}),Object(m.jsxs)(v.v,{id:"quotes",children:[Object(m.jsx)(v.n,{header:Object(m.jsx)(v.o,{mode:"secondary",children:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e"}),children:this.state.stocksMarket.map((function(t){return Object(m.jsx)(w,{a:t.priceBefore,b:1,c:t.price,v:t.ticker,p:!1,s:e.setActiveModal},t.price+t.ticker)}))}),Object(m.jsx)(v.n,{header:Object(m.jsx)(v.o,{mode:"secondary",children:"\u043d\u0430 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0439 \u043d\u0435\u0434\u0435\u043b\u0435"}),children:Object(m.jsx)(v.g,{children:this.state.stocksMarket.map((function(e,t){return Object(m.jsx)(z,{v:e},"horizontalcard"+t)}))})}),Object(m.jsx)("div",{style:{height:48}})]}),Object(m.jsx)(v.v,{id:"rating"})]})}),Object(m.jsx)(v.k,{children:Object(m.jsx)(v.j,{activeStory:this.state.activePanel,tabbar:Object(m.jsxs)(v.A,{children:[Object(m.jsx)(v.B,{selected:"portfolio"===this.state.activePanel,id:"portfolio",onClick:function(){return e.setActivePanel("portfolio")},text:"\u041f\u043e\u0440\u0442\u0444\u0435\u043b\u044c",children:Object(m.jsx)(g.a,{})}),Object(m.jsx)(v.B,{selected:"quotes"===this.state.activePanel,id:"quotes",onClick:function(){return e.setActivePanel("quotes")},text:"\u041c\u0430\u0440\u043a\u0435\u0442",children:Object(m.jsx)(x.a,{})}),Object(m.jsx)(v.B,{selected:"rating"===this.state.activePanel,id:"rating",onClick:function(){return e.setActivePanel("rating")},text:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433",children:Object(m.jsx)(O.a,{})})]})})})]})})})}}]),c}(a.a.Component);Object(v.F)(q);var L=q,T=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,166)).then((function(t){var c=t.getCLS,s=t.getFID,a=t.getFCP,n=t.getLCP,i=t.getTTFB;c(e),s(e),a(e),n(e),i(e)}))};i.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(L,{})}),document.getElementById("root")),T()},46:function(e,t,c){var s={"./adobe--big.svg":149,"./alphabet--big.svg":150,"./amazon--big.svg":151,"./american-express--big.svg":152,"./apple--big.svg":153,"./blackrock--big.svg":154,"./coca-cola--big.svg":155,"./garmin-ltd--big.svg":156,"./intel--big.svg":157,"./microsoft--big.svg":158};function a(e){var t=n(e);return c(t)}function n(e){if(!c.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}a.keys=function(){return Object.keys(s)},a.resolve=n,e.exports=a,a.id=46}},[[159,1,2]]]);
//# sourceMappingURL=main.126563b9.chunk.js.map